{% extends 'base.html' %}
{% load mathfilters %}
{% block content %}
<div class="container py-4">

  <!-- Questions List -->
  <div class="list-group shadow-sm mb-5">
    {% if question_list %}
      {% for question in question_list %}
        <a href="{% url 'pybo:detail' question.id %}"
           class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
          
          <div>
            <h5 class="mb-1">{{ question.subject }}</h5>
            <small class="text-muted">
              By {{ question.author }} &bull;
              {{ question.create_date|date:"Y-m-d H:i" }}
            </small>
          </div>
          
          {% if question.answer_set.count > 0 %}
            <span class="badge bg-danger rounded-pill">
              {{ question.answer_set.count }}
            </span>
          {% endif %}
        </a>
      {% endfor %}
    {% else %}
      <div class="list-group-item">
        <p class="mb-0 text-center text-muted">아직 작성된 글이 없습니다.</p>
      </div>
    {% endif %}
  </div>

  <!-- Fixed Footer with Pagination + Create Button -->
  <div class="position-fixed bottom-0 start-0 end-0 bg-white border-top py-2 shadow-lg">
    <div class="container d-flex justify-content-between align-items-center">

      <!-- Pagination -->
      <nav>
        <ul class="pagination mb-0">
          {% if question_list.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page={{question_list.previous_page_number}}">◀</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">◀</span></li>
          {% endif %}
          
          {% for page_number in question_list.paginator.page_range %}
            {% if page_number|add:-1|div:10|add:0 == question_list.number|add:-1|div:10|add:0 %}
              <li class="page-item {% if page_number == question_list.number %}active{% endif %}">
                <a class="page-link" href="?page={{ page_number }}">{{ page_number }}</a>
              </li>
            {% endif %}
          {% endfor %}

          {% if question_list.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ question_list.next_page_number }}">▶</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">▶</span></li>
          {% endif %}
        </ul>
      </nav>

      <!-- Create Button -->
      <a href="{% url 'pybo:question_create' %}" class="btn btn-primary">
        새 글 작성
      </a>
    </div>
  </div>

</div>
{% endblock %}
