{% extends 'base.html' %}
{% load static %}
{% load mathfilters %}

{% block head %}
<link rel="stylesheet" href="{% static 'bootstrap.min.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid text-center mt-4">
    <div class="row">
        <div class="col-sm-8">
            <div class="card w-100" style="height: 30vh;">
                <div class="card-body p-2 overflow-auto">
                    <!-- ÎìúÎ°≠Îã§Ïö¥ -->
                    <div class="d-flex justify-content-between mb-0 py-0">
                        <h4 style="outline: 2px solid #646464;">127.0.0.2</h4>
                        <div class="mb-0">
                            <div class="dropdown">
                                <button class="btn btn-outline-dark dropdown-toggle float-end" type="button"
                                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                    server list
                                </button>
                                <ul class="dropdown-menu w-30" aria-labelledby="dropdownMenuButton">
                                    <li><a class="dropdown-item" href="#">127.0.0.1</a></li>
                                    <li><a class="dropdown-item" href="#">localhost</a></li>
                                    <li><a class="dropdown-item" href="#">None</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- ÌÖåÏù¥Î∏î -->
                    <table class="table table-striped mt-1" style="outline: 2px solid #646464;">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">CONTAINER ID</th>
                                <th scope="col">IMAGE</th>
                                <th scope="col">STATUS</th>
                                <th scope="col">CREATED</th>
                                <th scope="col">NAMES</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>1d2bcd83ab69</td>
                                <td>cd484474f5fe</td>
                                <td>Up 2 days</td>
                                <td>2 days ago</td>
                                <td>test</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!--  -->
        <div class="col-sm-4">
            <div class="card w-100" style="height: 30vh;">
                <div class="card-body p-2 overflow-auto">
                    <!-- ÎìúÎ°≠Îã§Ïö¥ -->
                    <div class="d-flex justify-content-between mb-0 py-0">
                        <h4 style="outline: 2px solid #646464;">127.0.0.2</h4>
                        <div class="mb-0">
                            <div class="dropdown">
                                <button class="btn btn-outline-dark dropdown-toggle float-end" type="button"
                                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                    None
                                </button>
                                <ul class="dropdown-menu w-30" aria-labelledby="dropdownMenuButton">
                                    <li><a class="dropdown-item" href="#">Ïñ¥Îñ§</a></li>
                                    <li><a class="dropdown-item" href="#">Í∏∞Îä•ÏùÑ</a></li>
                                    <li><a class="dropdown-item" href="#">ÎÑ£ÏùÑÍπåÏöî~</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- ÌÖåÏù¥Î∏î -->
                    <table class="table table-striped mt-1" style="outline: 2px solid #646464;">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Î¨¥</th>
                                <th scope="col">Ïóá</th>
                                <th scope="col">ÏùÑ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>ÎÑ£</td>
                                <td>ÏùÑ</td>
                                <td>Íπå</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <div class="row py-2">
        <div class="col-6">
            <h4>üìä Disk Usage Overview</h4>
            <div class="card w-100 p-2" style="height: 30vh;">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <strong>/tmp</strong>
                        <span>5%</span>
                    </div>
                    <div class="progress" style="height: 25px;">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="20"
                            aria-valuemin="0" aria-valuemax="100">
                            31G / 63G
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-6">
            <h4 class="text-center">üñ•Ô∏è GPU ÏÇ¨Ïö©Îüâ</h4>
            <div class="card w-100 p-2" style="height: 30vh;">
                <canvas id="gpu-usage" style="width: 100%; height: 100%;"></canvas>
                
              </div>
        </div>
    </div>
</div>
</div>
{% endblock %}

{% block script %}
<script src="{% static 'chart.js' %}"></script>
<script>
fetch('/server_dashboard/gpu_info/')
  .then(res => res.json())
  .then(chartData => {
    const config = {
      type: 'bar',
      data: {
        labels: chartData.labels,
        datasets: [{
          label: 'GPU Usage (%)',
          data: chartData.data,
          backgroundColor: chartData.backgroundColors,
          borderColor: chartData.backgroundColors.map(c => c.replace('0.2', '1')),
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false, // Ïù¥ Î∂ÄÎ∂Ñ Ï∂îÍ∞Ä
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              stepSize: 10,
              callback: function(value) {
                return value + '%';
              }
            },
            max: 100
          }
        }
      }
    };

    new Chart(document.getElementById('gpu-usage'), config);
  });
</script>

<!-- bootstrap.bundle.min.jsÎßå Î°úÎìú -->
<script src="{% static 'bootstrap.bundle.min.js' %}"></script>
{% endblock %}

